var defaults_sticky = { widthActive: 1024, elementSidebar: null, distanceFixedTop: 15, startFixed: 100, endFixed: 700, distanceChangeTop: 700, startFixed2: 1600, endFixed2: 1900, distanceChangeTop2: 700, startFixed3: 2700, endFixed3: 3100, distanceChangeTop3: 700, startFixed4: 4400, endFixed4: 4900, connectElement: "#connectId", connectElementFixedTop: 550, connectElement2: "#connectId2", connectElementFixedTop2: 550, sidebarStickyMode: "sticky", endFixedElement: null, paddingSidebar: !1, wSidebar: null, wWidgets: null, setHeightSidebar: null }; let widthBody = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth; var config = Object.assign({}, defaults_sticky, vi_stickyConfig), mainSidebar = document.querySelector(config.elementSidebar); if (mainSidebar && widthBody > config.widthActive) { var widthSidebar = 0, widthWidgets = 0; function getValueCss(e, t) { var i = window.getComputedStyle(e)[t]; return parseInt(i.replace("px", "")) } var replicaSidebar = mainSidebar, oldElemSidebar = replicaSidebar.innerHTML, newElemSidebar = "<div id='vi-sticky'>" + oldElemSidebar + "</div>"; if (replicaSidebar.innerHTML = newElemSidebar, widthSidebar = replicaSidebar.offsetWidth, config.setHeightSidebar && config.setHeightSidebar > 0) { var viStickys = document.getElementById("vi-sticky"); viStickys.style.height = config.setHeightSidebar + "px" } if (config.paddingSidebar) { var styleSidebar = window.getComputedStyle ? getComputedStyle(replicaSidebar, null) : replicaSidebar.currentStyle, pLeft = parseInt(styleSidebar.paddingLeft) || 0, pRight = parseInt(styleSidebar.paddingRight) || 0; widthSidebar = replicaSidebar.offsetWidth - pLeft - pRight } function between(e, t, i) { return e > t && e <= i } function handlerStickySidebar() { var e = document.getElementById("vi-sticky"), t = document.getElementsByClassName("vi-sticky-ad"), i = document.documentElement.scrollTop; if (t.length <= 1 && (config.sidebarStickyMode = "normal"), e) if ("normal" === config.sidebarStickyMode) e.style.position = "", e.style.top = ""; else { for (let e = 0; e < t.length; e++)t[e].style.opacity = 1, t[e].style.visibility = "visible"; if (i < config.startFixed && (e.style.position = "", e.style.top = "", e.style.width = ""), i > config.startFixed && i < config.endFixed && (e.style.position = "fixed", e.style.top = (config.distanceFixedTop ? config.distanceFixedTop : 0) + "px", e.style.width = widthSidebar + "px", t[0] && (t[0].style.position = "", t[0].style.top = "")), i > config.endFixed && (e.style.position = "relative", e.style.top = config.distanceChangeTop + "px", e.style.width = widthSidebar + "px", t.length > 1 && i < config.startFixed2)) { if (t[1] && (t[1].style.position = "", t[1].style.top = "", t[1].style.width = widthWidgets + "px"), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "", n.style.width = widthSidebar + "px", n.style.top = ""); t[2] && (t[2].style.position = "", t[2].style.top = "", t[2].style.width = widthWidgets + "px"), t[3] && (t[3].style.position = "", t[3].style.top = "", t[3].style.width = widthWidgets + "px") } if (config.startFixed2 && config.endFixed2 && between(i, config.startFixed2, config.endFixed2) && t.length > 1) { if (e.style.position = "", e.style.top = "", t[1] && (t[1].style.position = "fixed", t[1].style.top = (config.distanceFixedTop2 ? config.distanceFixedTop2 : config.distanceFixedTop) + "px", t[1].style.width = widthWidgets + "px", t[1].style.opacity = 1, t[1].style.visibility = "visible"), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "fixed", n.style.width = widthSidebar + "px", n.style.top = config.connectElementFixedTop + "px", n.style.left = "unset", n.style.right = "unset"); if (t[2] && (t[2].style.position = "fixed", t[2].style.width = widthWidgets + "px", t[2].style.top = config.connectElementFixedTop + n.offsetHeight + getValueCss(n, "margin-top") + getValueCss(n, "margin-bottom") + "px", t[2].style.opacity = 1, t[2].style.visibility = "visible"), config.connectElement2) (o = document.querySelector(config.connectElement2)) && (o.style.position = "fixed", o.style.width = widthSidebar + "px", o.style.top = config.connectElementFixedTop2 + n.offsetHeight + config.connectElementFixedTop + 15 + "px", o.style.left = "unset", o.style.right = "unset"); t[3] && (t[3].style.position = "fixed", t[3].style.width = widthWidgets + "px", t[3].style.top = config.connectElementFixedTop + n.offsetHeight + getValueCss(n, "margin-top") + getValueCss(n, "margin-bottom") + "px", t[3].style.opacity = 1, t[3].style.visibility = "visible") } if (i > config.endFixed2 && (e.style.position = "relative", e.style.top = config.distanceChangeTop2 + "px", e.style.width = widthSidebar + "px", t.length > 2 && i < config.startFixed3)) { if (t[1] && (t[1].style.position = "", t[1].style.top = "", t[1].style.width = widthWidgets + "px"), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "", n.style.width = widthSidebar + "px", n.style.top = ""); if (t[2] && (t[2].style.position = "", t[2].style.top = "", t[2].style.width = widthWidgets + "px"), config.connectElement2) (o = document.querySelector(config.connectElement2)) && (o.style.position = "", o.style.width = widthSidebar + "px", o.style.top = ""); t[3] && (t[3].style.position = "", t[3].style.top = "", t[3].style.width = widthWidgets + "px") } if (config.startFixed3 && config.endFixed3 && between(i, config.startFixed3, config.endFixed3) && t.length > 2) { if (e.style.position = "", e.style.top = "", t[2] && (t[2].style.position = "fixed", t[2].style.top = (config.distanceFixedTop3 ? config.distanceFixedTop3 : config.distanceFixedTop) + "px", t[2].style.width = widthWidgets + "px", t[2].style.opacity = 1, t[2].style.visibility = "visible"), t[1] && (t[1].style.position = "", t[1].style.width = widthWidgets + "px", t[1].style.top = "", t[1].style.opacity = 1, t[1].style.visibility = "visible"), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "", n.style.width = widthSidebar + "px", n.style.top = ""); if (config.connectElement2) (o = document.querySelector(config.connectElement2)) && (o.style.position = "fixed", o.style.width = widthSidebar + "px", o.style.top = config.connectElementFixedTop2 + "px"); t[3] && (t[3].style.position = "fixed", t[3].style.width = widthWidgets + "px", t[3].style.top = config.connectElementFixedTop2 + o.offsetHeight + getValueCss(o, "margin-top") + getValueCss(o, "margin-bottom") + "px", t[3].style.opacity = 1, t[3].style.visibility = "visible") } if (i > config.endFixed3 && (e.style.position = "relative", e.style.top = config.distanceChangeTop3 + "px", e.style.width = widthSidebar + "px", t.length > 3 && i < config.startFixed4)) { if (t[2] && (t[2].style.position = "", t[2].style.top = "", t[2].style.width = widthWidgets + "px"), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "", n.style.width = widthSidebar + "px", n.style.top = ""); if (config.connectElement2) (o = document.querySelector(config.connectElement2)) && (o.style.position = "", o.style.width = widthSidebar + "px", o.style.top = ""); t[3] && (t[3].style.position = "", t[3].style.top = "", t[3].style.width = widthWidgets + "px") } if (config.startFixed4 && config.endFixed4 && between(i, config.startFixed4, config.endFixed4) && t.length > 3) { var n, o; if (e.style.position = "", e.style.top = "", t[3] && (t[3].style.position = "fixed", t[3].style.top = (config.distanceFixedTop4 ? config.distanceFixedTop4 : config.distanceFixedTop) + "px", t[3].style.width = widthWidgets + "px", t[3].style.opacity = 1, t[3].style.opacity = 1, t[3].style.visibility = "visible"), t[1] && (t[1].style.position = "", t[1].style.width = widthWidgets + "px", t[1].style.top = ""), t[2] && (t[2].style.position = "", t[2].style.width = widthWidgets + "px", t[2].style.top = ""), config.connectElement) (n = document.querySelector(config.connectElement)) && (n.style.position = "", n.style.width = widthSidebar + "px", n.style.top = ""); if (config.connectElement2) (o = document.querySelector(config.connectElement2)) && (o.style.position = "", o.style.width = widthSidebar + "px", o.style.top = "") } if ("" != config.endFixedElement) { var d = null; (d = document.querySelector(config.endFixedElement)) && d.getBoundingClientRect().top < 500 && (e.style.position = "", e.style.top = "", t[1] && (t[1].style.opacity = 0, t[1].style.visibility = "hidden"), t[2] && (t[2].style.opacity = 0, t[2].style.visibility = "hidden"), t[3] && (t[3].style.opacity = 0, t[3].style.visibility = "hidden")) } } } config.wSidebar && (widthSidebar = config.wSidebar), widthWidgets = widthSidebar, config.wWidgets && config.wWidgets > 0 && (widthWidgets = config.wWidgets) } "sticky" === config.sidebarStickyMode && window.addEventListener("scroll", function () { if ((window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth) >= config.widthActive) try { handlerStickySidebar() } catch (e) { } });